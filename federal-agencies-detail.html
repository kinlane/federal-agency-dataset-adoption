---
layout: page
title: Federal Agency
---
{% raw  %}
<script id="agencyTemplate" type="text/template">
    <center><h2>{{name}}</h2></center>
    <p align="center"><img src="{{logo}}" width="250" style="padding: 15px;" /></a></p>
    <p align="center">
        <a href="{{url}}" target="_blank" title="{{name}}">{{url}}</a>
     </p>      
</script>
{% endraw %}

<div>
    <div id="agencyDetail"> </div>
</div>  

<script type="text/javascript">
function getFederAgencyDetails(thisagencyid)
    {
    $.getJSON('data/federal-agencies.json', function(data) {
        
         $.each(data['agencies'], function(key, val) {
            
            agency_id = val['agency_id']; 

            if(thisagencyid == agency_id)
                {
                    
                var template = $('#agencyTemplate').html();
                var html = Mustache.to_html(template, val);
                $('#agencyDetail').append(html);     
               
                
                }
            });                                    
        });
    }  

var agencyid = getUrlVar('agency_id');
getFederAgencyDetails(agencyid);
</script>

{% raw  %}
<script id="agencydatatemplate" type="text/template">
    <tr>
        <td>
            <strong>{{title}}</strong>
            <div style="display:none; width: 100%; margin-top: 5px;" id="{{agency_id}}-{{unique}}-description">{{description}}</div>
            <div style="display:none; width: 100%; margin-top: 5px;" id="{{agency_id}}-{{unique}}-distributions"><ul id="{{unique}}-distribution-list"></div>
        </td>
        <td><a href="#" onclick="showDIV('{{agency_id}}-{{unique}}-description'); return false;" title="Description of dataset"><span class="label label-primary">D</span></a></td>
        <td><a href="#" onclick="showDIV('{{agency_id}}-{{unique}}-distributions'); return false;" title="Distributions of dataset"><span class="label label-primary">D</span></a></td>
        <td id="{{agency_id}}-{{unique}}-download-url"><a href="{{download_url}}" target="_blank"><span class="label label-primary" title="Download URL (if used)">L</span></a></td>
        <td id="{{agency_id}}-{{unique}}-access-url"><a href="{{accessURL}}" target="_blank"><span class="label label-primary" title="Access URL (if used)">A</span></a></td>
    </tr>    
</script>
<script id="agencydatadistributiontemplate" type="text/template">
    <li><a href="{{accessURL}}" target="_blank">{{accessURL}}</a></li>
</script>
{% endraw %}

<p align="center" id="agency-dataset-count">Total Number of Datasets = 0</p>

<div class="table-responsive">
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>Title</th>
            <th></th>
            <th></th>
            <th></th>
          </tr>
        </thead>  
        <tbody id="agencydata">
            
        </tbody>      
    </table>
</div>  

<script type="text/javascript">

function showDIV(r)
    {
    $row = document.getElementById(r);    
    //alert($row.style.display);
    if($row.style.display=='none')
        {
        $row.style.display='';    
        }   
    else
        {
        $row.style.display='none';        
        }
    }
    
function getFederalAgencyDatasets(thisagencyid)
    {
    agencydatajsonurl = '/data/' + thisagencyid + '.json';    
    $.getJSON(agencydatajsonurl, function(data) {
        
         datasetcount = data.length;
         document.getElementById('agency-dataset-count').innerHTML = 'Total Number of Datasets = ' + datasetcount;
         
         $.each(data, function(key, val) {  
             
            unique = val['unique']; 
            distribution = val['distribution'];
                             
            var template = $('#agencydatatemplate').html();
            var html = Mustache.to_html(template, val);
            $('#agencydata').append(html); 
                
             $.each(distribution, function(key2, val2) {  
                var template = $('#agencydatadistributiontemplate').html();
                var html = Mustache.to_html(template, val2);
                $('#'+agencyid+'-'+unique+'-distribution-list').append(html);                    
                });                 
                
            $download_url = val['download_url'];   
            if($download_url)
                {
                if($download_url.length < 5)
                    {
                    id = agencyid + '-' + unique + '-download-url';
                    document.getElementById(id).innerHTML = '';
                    }
                }
            $accessURL = val['accessURL'];       
            if($accessUR)
                {
                if($accessURL.length < 5)
                    {
                    id = agencyid + '-' + unique + '-access-url';
                    document.getElementById(id).innerHTML = '';
                    }                
                }
            });                                    
        });
    }  
getFederalAgencyDatasets(agencyid);    
</script>
